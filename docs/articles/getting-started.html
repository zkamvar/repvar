<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started • repvar</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">repvar</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting Started</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting Started</h1>
                        <h4 class="author">Zhian N. Kamvar and Sydney E. Everhart</h4>
            
            <h4 class="date">2018-04-05</h4>
      
      
      <p class="hidden name"><code>getting-started.Rmd</code></p>

    </div>

    
    
<div id="what-the-repvar-package-does" class="section level1">
<h1 class="hasAnchor">
<a href="#what-the-repvar-package-does" class="anchor"></a>What the repvar package does</h1>
<p>The repvar package is designed to provide a simple way of finding the minimum number of samples needed to <strong>rep</strong>resent all <strong>var</strong>iables in a given sparse binary matrix. The impetus for this was driven by a need to resequence a small set of samples from a population genetic study to serve as positive controls for allele calls.</p>
<div id="how-it-works" class="section level2">
<h2 class="hasAnchor">
<a href="#how-it-works" class="anchor"></a>How it works</h2>
<p>The main algorithm is in the function <code><a href="../reference/rpv_indices.html">rpv_indices()</a></code>. In it’s simplest form, the algorithm works like so:</p>
<ol style="list-style-type: decimal">
<li>count the number of observations in each column and sort them</li>
<li>set a counter to count the number of columns that haven’t been accounted for</li>
<li>create a vector to store the sample names</li>
<li>while the counter is greater than zero
<ol style="list-style-type: lower-roman">
<li>record the first sample from each of the columns with the smallest number of observations</li>
<li>take the union of those sample names and any other sample names that have been collected</li>
<li>remove the columns these samples represent from the original column list</li>
<li>set the counter to the number of columns left in the original column list</li>
</ol>
</li>
<li>verify that all the columns have been accounted for by the sample names</li>
<li>return the vector of sample names</li>
</ol>
</div>
<div id="functions-in-this-package" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-in-this-package" class="anchor"></a>Functions in this package</h2>
<p>There are four functions in this package:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/rpv_indices.html">rpv_indices()</a></code> searches a matrix with the above algorithm and returns a vector of rownames for that matrix.</li>
<li>
<code><a href="../reference/rpv_find.html">rpv_find()</a></code> randomizes the rows of the matrix and performs <code><a href="../reference/rpv_indices.html">rpv_indices()</a></code> on the randomizations to return a list of candidates to be the minimum set.</li>
<li>
<code><a href="../reference/rpv_stats.html">rpv_stats()</a></code> computes diversity indices for a matrix.</li>
<li>
<code><a href="../reference/rpv_image.html">rpv_image()</a></code> allows you to visualize your matrix as an image.</li>
</ol>
</div>
<div id="quickstart" class="section level2">
<h2 class="hasAnchor">
<a href="#quickstart" class="anchor"></a>Quickstart</h2>
<p>Because there are several possibilities for minimum number of samples, the data should be randomized and iterated over several times. This can be done with <code><a href="../reference/rpv_find.html">rpv_find()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"repvar"</span>)
<span class="kw">data</span>(<span class="st">"monilinia"</span>)
<span class="co"># First, view our data</span>
loci &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">strsplit</span>(<span class="kw">colnames</span>(monilinia), <span class="st">"[.]"</span>), <span class="st">"["</span>, <span class="dv">1</span>)
<span class="kw"><a href="../reference/rpv_image.html">rpv_image</a></span>(monilinia, <span class="dt">f =</span> loci)</code></pre></div>
<p><img src="getting-started_files/figure-html/quickstart-1.png" width="500px" height="500px"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Now randomly sample 200 times to get a set of vectors</span>
<span class="kw">set.seed</span>(<span class="dv">2018</span>)
id_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rpv_find.html">rpv_find</a></span>(monilinia, <span class="dt">n =</span> <span class="dv">200</span>, <span class="dt">cut =</span> <span class="ot">TRUE</span>, <span class="dt">progress =</span> <span class="ot">FALSE</span>)
id_list
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;  [1] "A233" "A610" "A154" "A603" "A666" "A163" "A293" "A339" "A590" "A071"</span>
<span class="co">#&gt; [11] "A085" "A218" "A269" "A074" "A182" "A417" "A681" "A176" "A366" "A489"</span>
<span class="co">#&gt; [21] "A216" "A172" "A488" "A406" "A390" "A039" "A010" "A016" "A692" "A129"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;  [1] "A233" "A610" "A154" "A603" "A666" "A163" "A293" "A339" "A590" "A071"</span>
<span class="co">#&gt; [11] "A085" "A218" "A269" "A074" "A182" "A417" "A681" "A176" "A367" "A489"</span>
<span class="co">#&gt; [21] "A191" "A172" "A488" "A408" "A390" "A404" "A387" "A016" "A692" "A571"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt;  [1] "A233" "A610" "A154" "A603" "A666" "A163" "A293" "A339" "A590" "A071"</span>
<span class="co">#&gt; [11] "A085" "A218" "A269" "A074" "A182" "A417" "A681" "A176" "A367" "A522"</span>
<span class="co">#&gt; [21] "A191" "A172" "A488" "A408" "A390" "A547" "A385" "A480" "A692" "A088"</span>
<span class="kw">lengths</span>(id_list)
<span class="co">#&gt; [1] 30 30 30</span></code></pre></div>
<p>We can see here that we have 3 possible sets of samples that have 30 samples each. We can compare them using <code><a href="../reference/rpv_stats.html">rpv_stats()</a></code>, which calculate entropy statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">do.call</span>(<span class="st">"rbind"</span>, <span class="kw">lapply</span>(id_list, <span class="cf">function</span>(i) <span class="kw"><a href="../reference/rpv_stats.html">rpv_stats</a></span>(monilinia[i, ])))
<span class="co">#&gt;         eH        G        E5    lambda     missing</span>
<span class="co">#&gt; 1 55.22702 39.72137 0.7140605 0.9773436 0.005964912</span>
<span class="co">#&gt; 2 55.31349 39.77928 0.7139899 0.9773868 0.007719298</span>
<span class="co">#&gt; 3 54.74656 39.05319 0.7080117 0.9769182 0.007719298</span></code></pre></div>
<p>From this, we can see that they are all relatively equivalent, but the first set has the least missing data and the greatest evenness (E5).</p>
<p>Let’s see what samples this represents:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rpv_image.html">rpv_image</a></span>(monilinia, <span class="dt">f =</span> loci, <span class="dt">highlight =</span> id_list[[<span class="dv">1</span>]])</code></pre></div>
<p><img src="getting-started_files/figure-html/highlight-1.png" width="500px" height="500px"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rpv_image.html">rpv_image</a></span>(monilinia[id_list[[<span class="dv">1</span>]], ], <span class="dt">f =</span> loci)</code></pre></div>
<p><img src="getting-started_files/figure-html/highlight2-1.png" width="500px" height="250px"></p>
</div>
</div>
<div id="detailed-example-monilinia-fructicola" class="section level1">
<h1 class="hasAnchor">
<a href="#detailed-example-monilinia-fructicola" class="anchor"></a>Detailed Example: <em>Monilinia fructicola</em>
</h1>
<p>To demonstrate why we need to shuffle the data, we will be using a data set representing 264 samples of <em>Monilinia fructicola</em> collected from peach orchards in Georgia genotyped at 13 microsatellite loci representing 95 alleles. The data are stored in a 264x95 matrix where each row represents a sample and each column represents an allele. Black cells indicate the presence of an allele, blue cells indicate an absence and white cells indicate missing data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"repvar"</span>)
<span class="kw">data</span>(<span class="st">"monilinia"</span>)
loci &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">strsplit</span>(<span class="kw">colnames</span>(monilinia), <span class="st">"[.]"</span>), <span class="st">"["</span>, <span class="dv">1</span>)
<span class="kw"><a href="../reference/rpv_image.html">rpv_image</a></span>(monilinia, <span class="dt">f =</span> loci)</code></pre></div>
<p><img src="getting-started_files/figure-html/show_monilinia-1.png" width="500px" height="500px"></p>
<p>Immediately you should be able to see that some loci—like CHMFc4—have few alleles that are fairly well-represented while other loci—like SEA—have several alleles with the majority of them represented by a handful of samples.</p>
<p>If we run <code><a href="../reference/rpv_indices.html">rpv_indices()</a></code> on our data, we get a vector of samples that represent all of the alleles:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(ids &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rpv_indices.html">rpv_indices</a></span>(monilinia))
<span class="co">#&gt;  [1] "A233" "A610" "A154" "A603" "A666" "A163" "A293" "A339" "A590" "A071"</span>
<span class="co">#&gt; [11] "A085" "A218" "A269" "A074" "A182" "A417" "A681" "A008" "A366" "A176"</span>
<span class="co">#&gt; [21] "A489" "A191" "A172" "A394" "A406" "A390" "A039" "A010" "A016" "A398"</span>
<span class="co">#&gt; [31] "A034" "A088" "A012"</span>
<span class="kw">length</span>(ids)
<span class="co">#&gt; [1] 33</span>
<span class="kw">colSums</span>(monilinia[ids, ]) <span class="co"># all of the variables are represented</span>
<span class="co">#&gt;  CHMFc4.224  CHMFc4.231  CHMFc4.238   CHMFc5.85   CHMFc5.97  CHMFc5.111 </span>
<span class="co">#&gt;          16          15           2          NA          NA          NA </span>
<span class="co">#&gt;  CHMFc5.105  CHMFc5.107  CHMFc5.113 CHMFc12.163 CHMFc12.159 CHMFc12.169 </span>
<span class="co">#&gt;          NA          NA          NA          NA          NA          NA </span>
<span class="co">#&gt;     SEA.132     SEA.156     SEA.160     SEA.128     SEA.136     SEA.152 </span>
<span class="co">#&gt;          19           4           1           1           1           1 </span>
<span class="co">#&gt;     SEA.144     SEA.140     SEA.164     SEA.176     SEA.148     SED.133 </span>
<span class="co">#&gt;           1           2           1           1           1           9 </span>
<span class="co">#&gt;     SED.129     SED.145     SED.109     SED.137     SED.141     SED.149 </span>
<span class="co">#&gt;           4           4           5           1           7           1 </span>
<span class="co">#&gt;     SED.125     SED.187     SEE.156     SEE.148     SEE.160     SEE.152 </span>
<span class="co">#&gt;           1           1          25           5           1           1 </span>
<span class="co">#&gt;     SEE.164     SEG.144     SEG.126     SEG.138     SEG.120     SEG.154 </span>
<span class="co">#&gt;           1          15           2          11           1           1 </span>
<span class="co">#&gt;     SEG.149     SEG.132     SEG.159     SEI.116     SEI.113     SEI.119 </span>
<span class="co">#&gt;           1           1           1          12          12           4 </span>
<span class="co">#&gt;     SEI.122     SEI.110     SEI.103     SEI.100     SEL.143     SEL.147 </span>
<span class="co">#&gt;           1           2           1           1           7          12 </span>
<span class="co">#&gt;     SEL.139     SEL.151     SEL.135     SEN.227     SEN.231     SEN.235 </span>
<span class="co">#&gt;          12           1           1          10          13           3 </span>
<span class="co">#&gt;     SEN.223     SEN.219     SEN.273     SEN.256     SEN.215     SEN.248 </span>
<span class="co">#&gt;           1           2           1           1           1           1 </span>
<span class="co">#&gt;     SEP.257     SEP.261     SEP.273     SEP.237     SEP.265     SEP.247 </span>
<span class="co">#&gt;           5          18           3           1           3           1 </span>
<span class="co">#&gt;     SEP.245     SEP.254     SEQ.142     SEQ.136     SEQ.134     SEQ.138 </span>
<span class="co">#&gt;           1           1          NA          NA          NA          NA </span>
<span class="co">#&gt;     SEQ.152     SEQ.140     SEQ.132     SEQ.154     SEQ.146     SEQ.144 </span>
<span class="co">#&gt;          NA          NA          NA          NA          NA          NA </span>
<span class="co">#&gt;     SEQ.130     SER.145     SER.153     SER.149     SER.141     SER.137 </span>
<span class="co">#&gt;          NA          10           2          11           2           3 </span>
<span class="co">#&gt;     SER.157     SER.165     SER.133     SER.182     SER.147 </span>
<span class="co">#&gt;           1           1           1           1           1</span></code></pre></div>
<p>Let’s highlight where these sampels came from:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rpv_image.html">rpv_image</a></span>(monilinia, <span class="dt">f =</span> loci, <span class="dt">highlight =</span> ids)</code></pre></div>
<p><img src="getting-started_files/figure-html/global_show-1.png" width="500px" height="500px"></p>
<p>If we visualize just these samples, we can see that each locus is accounted for at least once:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rpv_image.html">rpv_image</a></span>(monilinia[ids, ], <span class="dt">f =</span> loci)</code></pre></div>
<p><img src="getting-started_files/figure-html/ex1_show2-1.png" width="500px" height="250px"></p>
<p>However, if we shuffle the data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2018</span>)
monilinia_shuffled &lt;-<span class="st"> </span>monilinia[<span class="kw">sample</span>(<span class="kw">nrow</span>(monilinia)), ]
<span class="kw"><a href="../reference/rpv_image.html">rpv_image</a></span>(monilinia_shuffled, <span class="dt">f =</span> loci) <span class="co"># shuffled data</span></code></pre></div>
<p><img src="getting-started_files/figure-html/ex1_shuffle-1.png" width="500px" height="500px"></p>
<p>We get a different answer:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(new_ids &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rpv_indices.html">rpv_indices</a></span>(monilinia_shuffled))
<span class="co">#&gt;  [1] "A233" "A610" "A154" "A603" "A666" "A163" "A293" "A339" "A590" "A071"</span>
<span class="co">#&gt; [11] "A085" "A218" "A269" "A074" "A182" "A417" "A681" "A176" "A366" "A513"</span>
<span class="co">#&gt; [21] "A522" "A216" "A488" "A406" "A390" "A547" "A387" "A016" "A692" "A162"</span>
<span class="co">#&gt; [31] "A500" "A007"</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw"><a href="../reference/rpv_image.html">rpv_image</a></span>(monilinia, <span class="dt">f =</span> loci, <span class="dt">highlight =</span> new_ids, 
          <span class="dt">newplot =</span> <span class="ot">FALSE</span>,                 <span class="co"># avoid creating a new plot</span>
          <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">"grey95"</span>, <span class="st">"grey10"</span>),     <span class="co"># color background grey</span>
          <span class="dt">idcol =</span> <span class="kw">c</span>(<span class="st">"#B15928"</span>, <span class="st">"#FFFF99"</span>)  <span class="co"># reverse foreground colors</span>
          )
<span class="kw"><a href="../reference/rpv_image.html">rpv_image</a></span>(monilinia, <span class="dt">f =</span> loci, <span class="dt">highlight =</span> ids, 
          <span class="dt">newplot =</span> <span class="ot">FALSE</span>,                 <span class="co"># avoid creating a new plot</span>
          <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">"grey95"</span>, <span class="st">"grey10"</span>),     <span class="co"># color background grey</span>
          <span class="dt">idcol =</span> <span class="kw">c</span>(<span class="st">"#B15928"</span>, <span class="st">"#FFFF99"</span>)  <span class="co"># reverse foreground colors</span>
          )</code></pre></div>
<p><img src="getting-started_files/figure-html/ex1_show-1.png" width="1000px" height="500px"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#what-the-repvar-package-does">What the repvar package does</a><ul class="nav nav-pills nav-stacked">
<li><a href="#how-it-works">How it works</a></li>
      <li><a href="#functions-in-this-package">Functions in this package</a></li>
      <li><a href="#quickstart">Quickstart</a></li>
      </ul>
</li>
      <li><a href="#detailed-example-monilinia-fructicola">Detailed Example: <em>Monilinia fructicola</em></a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Zhian N. Kamvar.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
